# 常用信息收集

### 查询网络配置信息

```
ipconfig /all
```

### 查询操作系统版本

```
systeminfo | findstr /B /C:"OS"
```

### 查询架构

```
echo %PROCESSOR_ARCHITECTURE%
```

### **查看安装的软件版本信息**

使用wmic命令

```
wmic product get name,version
```

使用powershell

```
powershell "Get-WmiObject -class Win32_Product | Select-Object -Property name,version"
```

### 查询服务信息

```
wmic service list brief
```

### 查询进程列表

```
tasklist
```

或者

```
wmic process list brief
```

### 查看启动程序信息

```
wmic startup get command,caption
```

### 查看计划任务

```
schtasks /query /fo LIST /v
```

### 查看开机时间

```
net statistics workstation
```

### 查询用户列表

```
net user
```

### 获取本地管理员信息

```
net localgroup administrators
```

### 查看当前在线用户

```
query user || qwinsta
```

### 查看或断开当前连接会话

```
net session
```

### 查看端口列表

```
netstat -ano
```

### 查看补丁列表

```
systeminfo
```

使用wmic

```
wmic qfe get Caption,Description,HotFixID,InstalledOn
```

### 查询共享列表

```
net share
```

使用wmic

```
wmic share get name,path,status
```

### 查询路由表

```
route print
```

或者

```
arp -a
```

### 防火墙相关

关闭防火墙(Windows 2003以及更老版本)

```
netsh firewall set opmode disable
```

之后的版本

```
netsh advfirewall set allprofiles state off
```

查看防火墙配置

```
netsh firewall show config
```

修改防火墙配置(Windows 2003以及更老版本)允许指定程序全部链接

```
netsh firewall add allowedprogram c:\nc.exe "allow nc" enable
```

之后版本指定允许程序进入

```
net advfirewall firewall add rule name="pass nc" dir=in action=allow program="c:\nc.exe"
```

允许指定程序退出

```
net advfirewall firewall add rule name="Allow nc" dir=out action=allow program="c:\nc.exe"
```

3389端口开启

```
net advfirewall firewall add rule name="Remote Desktop" protocol=TCP dir=in localport=3389 action=allow
```

### 查看代理配置情况

```
reg query "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings"
```

### 查询并开启远程连接服务

查看远程链接端口

```
reg query "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /V PortNumber 
```

